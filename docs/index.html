<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Global Video Platforms Directory</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #4338ca 100%);
      background-attachment: fixed;
    }
    .card-glass {
      background: rgba(30, 41, 59, 0.9);
      backdrop-filter: blur(12px);
    }
    mark {
      background: #facc15; /* yellow-400 */
      color: black;
      padding: 0 2px;
      border-radius: 3px;
    }
    /* Fade-in animation */
    #backToTop, #scrollToBottom {
      animation: fadeInSoft .4s ease-out;
    }
    @keyframes fadeInSoft {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 0.8; transform: translateY(0); }
    }
    @media (prefers-reduced-motion: reduce) {
      #backToTop, #scrollToBottom { transition: none !important; animation: none !important; }
    }
    @media print {
      #scrollControls { display: none !important; }
    }
    /* Glow on hover */
    #backToTop:hover, #scrollToBottom:hover {
      box-shadow: 0 0 20px rgba(255,255,255,0.4);
    }
  </style>
</head>
<body class="min-h-screen flex flex-col text-gray-100">

  <!-- Header -->
  <header class="w-full text-center py-8 bg-gradient-to-r from-blue-700 via-purple-700 to-pink-700 shadow-lg">
    <h1 class="text-3xl md:text-5xl font-extrabold text-white drop-shadow-lg">
      üåç Global Video Platforms Directory
    </h1>
    <p class="text-gray-200 mt-3 text-lg">Explore worldwide platforms for tutorials & topic-wise search</p>
  </header>

  <!-- Main Content with Sidebar -->
  <div class="flex flex-1 w-[95%] mx-auto px-2 md:px-6 mt-6 space-x-6">

    <!-- Sidebar -->
    <aside class="w-64 card-glass rounded-2xl shadow-md border border-gray-700 p-5 h-fit sticky top-6">
      <h2 class="text-lg font-semibold text-white mb-4">üìÇ Categories</h2>
      <nav id="categoryMenu" class="space-y-2"></nav>
    </aside>

    <!-- Content Area -->
    <div class="flex-1">
      <!-- Search Bar -->
      <div class="w-full mb-8">
        <input id="search" type="text" 
               placeholder="üîç Search for a platform or topic..." 
               class="w-full p-4 rounded-xl border border-gray-600 shadow focus:ring-4 focus:ring-pink-500 focus:outline-none transition text-white bg-gray-800/80 placeholder-gray-300">
      </div>

      <!-- Platforms List -->
      <main id="platforms" class="space-y-12"></main>
    </div>
  </div>

<!-- Scroll Controls -->
<div id="scrollControls" class="fixed bottom-6 right-6 flex flex-col space-y-3 z-50">
  <!-- Back to Top -->
  <button id="backToTop" 
          class="hidden w-12 h-12 flex items-center justify-center rounded-full 
                 bg-gradient-to-r from-blue-500 to-purple-600 
                 shadow-lg opacity-80 hover:opacity-100 
                 hover:scale-110 transition transform text-white">
    <!-- Heroicon: Chevron Up -->
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M5 15l7-7 7 7" />
    </svg>
  </button>

  <!-- Scroll to Bottom -->
  <button id="scrollToBottom" 
          class="hidden w-12 h-12 flex items-center justify-center rounded-full 
                 bg-gradient-to-r from-pink-500 to-red-600 
                 shadow-lg opacity-80 hover:opacity-100 
                 hover:scale-110 transition transform text-white">
    <!-- Heroicon: Chevron Down -->
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M19 9l-7 7-7-7" />
    </svg>
  </button>
</div>

<br>
<!-- Footer -->
<footer class="mt-auto w-full py-4 text-center text-sm bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 border-t border-gray-700 text-gray-300">
  <p>
    ¬© <span id="year"></span> Created by 
    <a href="https://nemocyberworld.github.io" target="_blank" 
       class="font-semibold text-blue-400 hover:text-blue-500 transition">Captain Nemo</a> ¬∑ Collaboration with 
    <a href="https://hacktolive.net" target="_blank" 
       class="font-semibold text-pink-400 hover:text-pink-500 transition">HackToLive</a>
  </p>
</footer>

<script>
  // Dynamically update year
  document.getElementById("year").textContent = new Date().getFullYear();
</script>


<script>
  // Dynamically update year
  document.getElementById("year").textContent = new Date().getFullYear();
</script>


  <!-- Scroll Controls Script -->
  <script>
    (function () {
      const btnTop = document.getElementById('backToTop');
      const btnBottom = document.getElementById('scrollToBottom');

      function toggleButtons() {
        if (window.scrollY > 300) {
          btnTop.classList.remove('hidden');
        } else {
          btnTop.classList.add('hidden');
        }

        if (window.innerHeight + window.scrollY < document.body.offsetHeight - 300) {
          btnBottom.classList.remove('hidden');
        } else {
          btnBottom.classList.add('hidden');
        }
      }

      btnTop.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      btnBottom.addEventListener('click', () => {
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      });

      window.addEventListener('scroll', toggleButtons, { passive: true });
      window.addEventListener('load', toggleButtons);
    })();
  </script>

  <!-- Main Script (Categories + Search) -->
  <script>
    let sitesData = {};
    let currentCategory = null; // null => show all categories

    async function loadSites() {
      const response = await fetch("sites/sites.json");
      sitesData = await response.json();
      renderSidebar(sitesData);
      renderPlatforms();
    }

    function renderSidebar(data) {
      const sidebar = document.getElementById("categoryMenu");
      sidebar.innerHTML = "";

      // "All" button
      const allBtn = document.createElement("button");
      allBtn.className = "w-full text-left px-3 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold rounded-lg transition";
      allBtn.textContent = "All Platforms";
      allBtn.addEventListener("click", () => {
        currentCategory = null;
        showCategoryWithSearch();
      });
      sidebar.appendChild(allBtn);

      // Category buttons
      Object.keys(data).forEach(category => {
        const btn = document.createElement("button");
        btn.className = "w-full text-left px-3 py-2 bg-gray-700/70 hover:bg-gray-600 text-white font-medium rounded-lg transition";
        btn.textContent = category.charAt(0).toUpperCase() + category.slice(1);
        btn.addEventListener("click", () => {
          currentCategory = category;
          showCategoryWithSearch();
        });
        sidebar.appendChild(btn);
      });
    }

    function renderPlatforms() {
      const container = document.getElementById("platforms");
      container.innerHTML = "";
      if (currentCategory) {
        renderCategory(container, currentCategory, sitesData[currentCategory]);
      } else {
        Object.keys(sitesData).forEach(category => {
          renderCategory(container, category, sitesData[category]);
        });
      }
    }

    function renderCategory(container, category, sites) {
      const section = document.createElement("section");
      section.dataset.category = category;
      section.innerHTML = `
        <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-pink-400 mb-4 drop-shadow">
          ${category.charAt(0).toUpperCase() + category.slice(1)}
        </h2>
        <div class="grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(200px,1fr))]" id="cat-${category}"></div>
      `;
      container.appendChild(section);

      const grid = section.querySelector(`#cat-${category}`);
      sites.forEach(site => {
        const card = document.createElement("a");
        card.href = site.url;
        card.target = "_blank";
        card.className = `platform-card group card-glass border border-gray-600 rounded-2xl shadow-md hover:shadow-2xl hover:-translate-y-1 transform transition p-6 flex flex-col justify-between`;
        card.dataset.name = site.name;
        card.dataset.desc = site.desc;
        card.dataset.url = site.url;

        card.innerHTML = `
          <div>
            <h3 class="site-name text-lg font-extrabold text-white group-hover:text-yellow-300 drop-shadow-md">${site.name}</h3>
            <p class="site-desc text-gray-300 text-sm mt-2 leading-relaxed">${site.desc}</p>
          </div>
          <span class="mt-4 text-xs text-pink-400 group-hover:text-yellow-400 font-semibold">‚Üí Visit</span>
        `;
        grid.appendChild(card);
      });
    }

    // --- Filtering + highlighting helpers ---
    function highlightMatch(text, query) {
      if (!query) return text;
      const safeQuery = query.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      const regex = new RegExp(`(${safeQuery})`, "gi");
      return text.replace(regex, "<mark>$1</mark>");
    }

    function filterDataByQuery(query) {
      const q = query.trim().toLowerCase();
      const filtered = {};
      const categories = currentCategory ? [currentCategory] : Object.keys(sitesData);

      categories.forEach(cat => {
        const matches = sitesData[cat].filter(site => {
          const name = site.name.toLowerCase();
          const desc = site.desc.toLowerCase();
          return !q || name.includes(q) || desc.includes(q);
        });
        if (matches.length > 0) filtered[cat] = matches;
      });

      return filtered;
    }

    function renderFilteredPlatforms(filtered, query) {
      const container = document.getElementById("platforms");
      container.innerHTML = "";

      const cats = Object.keys(filtered);
      if (cats.length === 0) {
        showFallbackMessage(query);
        return;
      }

      cats.forEach(cat => {
        const section = document.createElement("section");
        section.innerHTML = `
          <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-pink-400 mb-4 drop-shadow">
            ${cat.charAt(0).toUpperCase() + cat.slice(1)}
          </h2>
          <div class="grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(200px,1fr))]" id="cat-${cat}"></div>
        `;
        container.appendChild(section);

        const grid = section.querySelector(`#cat-${cat}`);
        filtered[cat].forEach(site => {
          const card = document.createElement("a");
          card.href = site.url;
          card.target = "_blank";
          card.className = `platform-card group card-glass border border-gray-600 rounded-2xl shadow-md hover:shadow-2xl hover:-translate-y-1 transform transition p-6 flex flex-col justify-between`;
          const nameHighlighted = highlightMatch(site.name, query);
          const descHighlighted = highlightMatch(site.desc, query);

          card.innerHTML = `
            <div>
              <h3 class="site-name text-lg font-extrabold text-white group-hover:text-yellow-300 drop-shadow-md">${nameHighlighted}</h3>
              <p class="site-desc text-gray-300 text-sm mt-2 leading-relaxed">${descHighlighted}</p>
            </div>
            <span class="mt-4 text-xs text-pink-400 group-hover:text-yellow-400 font-semibold">‚Üí Visit</span>
          `;
          grid.appendChild(card);
        });
      });
    }

    // --- Fallback message helpers ---
    function showFallbackMessage(query) {
      const container = document.getElementById("platforms");
      container.innerHTML = `
        <div id="no-match-message" class="text-center text-gray-300 bg-gray-800/60 border border-gray-600 p-6 rounded-xl shadow-lg mt-6">
          <p class="text-lg font-semibold mb-2">
            No direct matches found for "<span class="text-yellow-400">${query}</span>".
          </p>
          <p class="text-sm">
            üëâ Please select a category from the left sidebar to refine your search for a specific site.
          </p>
        </div>
      `;
    }

    // --- Category-aware search rendering ---
    function showCategoryWithSearch() {
      const q = document.getElementById("search").value || "";
      if (!q.trim()) {
        renderPlatforms();
      } else {
        const filtered = filterDataByQuery(q);
        if (Object.keys(filtered).length === 0 && currentCategory) {
          renderCategory(document.getElementById("platforms"), currentCategory, sitesData[currentCategory]);
        } else {
          renderFilteredPlatforms(filtered, q);
        }
      }
    }

    // --- Search listener ---
    document.getElementById("search").addEventListener("input", function () {
      const query = this.value;
      if (!query.trim()) {
        renderPlatforms();
        return;
      }
      const filtered = filterDataByQuery(query);
      renderFilteredPlatforms(filtered, query);
    });

    loadSites();
  </script>
</body>
</html>
